<!DOCTYPE html>
<html lang="ar">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ููุญุฉ ุงูุฅุฏุงุฑุฉ ุงูุณุฑูุฉ | CoinFlow AI</title>
    <link rel="stylesheet" href="style.css">
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-auth.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-database.js"></script>
</head>
<body>

    <div class="container" id="adminAuth">
        <div class="glass-card" style="margin-top: 100px;">
            <h2 style="color: var(--primary);">ูุธุงู ุงูุชุญูู ุงููุฑูุฒู</h2>
            <p>ูุฑุฌู ุฅุฏุฎุงู ุฑูุฒ ุงููุตูู ูููุณุคูู</p>
            <input type="password" id="adminPin" placeholder="ุงูุฑูุฒ ุงูุณุฑู">
            <button onclick="checkAdmin()">ุฏุฎูู ุงููุธุงู</button>
        </div>
    </div>

    <div class="container" id="adminContent" style="display:none;">
        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
            <h1 style="color: var(--primary);">ุฅุฏุงุฑุฉ ุงููุณุชุฎุฏููู โ๏ธ</h1>
            <button onclick="location.reload()" style="width: 80px; font-size: 12px;">ุชุญุฏูุซ</button>
        </div>
        
        <div id="adminList">
            <p style="text-align: center;">ุฌุงุฑู ุชุญููู ุงูุจูุงูุงุช...</p>
        </div>
    </div>

    <script src="script.js"></script>
    <script>
        // ุงูุชุญูู ูู ุงูุฑูุฒ ุงูุณุฑู ุงูุฐู ุงุฎุชุฑุชู
        function checkAdmin() {
            const pin = document.getElementById('adminPin').value;
            if(pin === "30003100") { 
                document.getElementById('adminAuth').style.display = 'none';
                document.getElementById('adminContent').style.display = 'block';
                loadAdminData();
            } else {
                alert("โ๏ธ ุงูุฑูุฒ ุงูุณุฑู ุงูุฐู ุฃุฏุฎูุชู ุบูุฑ ุตุญูุญ!");
            }
        }

        // ุฌูุจ ุจูุงูุงุช ุฌููุน ุงููุณุชุฎุฏููู ูู Firebase
        function loadAdminData() {
            db.ref('users').on('value', s => {
                const users = s.val();
                let html = '';
                
                if(!users) {
                    html = '<div class="glass-card">ูุง ููุฌุฏ ูุณุชุฎุฏููู ูุณุฌููู ุจุนุฏ.</div>';
                } else {
                    for(let id in users) {
                        html += `
                        <div class="glass-card" style="text-align: right; margin-bottom: 15px; border-right: 4px solid var(--primary);">
                            <p style="color: var(--primary); font-weight: bold; margin-bottom: 5px;">๐ค ุจุฑูุฏ ุงููุณุชุฎุฏู:</p>
                            <p style="font-size: 14px;">${users[id].email}</p>
                            <hr style="border: 0.1px solid #1e293b; margin: 10px 0;">
                            <p>๐ฐ ุงูุฑุตูุฏ ุงูุญุงูู: <span style="color: #00ff00;">${(users[id].balance || 0).toFixed(2)} USDT</span></p>
                            
                            <div style="display: flex; gap: 10px; margin-top: 15px;">
                                <button onclick="setBal('${id}')" style="background: var(--secondary);">ุชุนุฏูู ุงูุฑุตูุฏ ๐ฐ</button>
                                <button onclick="reply('${id}')" style="background: #f39c12;">ุฑุฏ ุฏุฑุฏุดุฉ ๐ฌ</button>
                            </div>
                        </div>`;
                    }
                }
                document.getElementById('adminList').innerHTML = html;
            });
        }

        // ุฏุงูุฉ ุชุบููุฑ ุงูุฑุตูุฏ
        function setBal(id) {
            let amount = parseFloat(prompt("ุฃุฏุฎู ุงูุฑุตูุฏ ุงูุฌุฏูุฏ ุจุงูุฏููุงุฑ (ุณูุชู ุงุณุชุจุฏุงู ุงูุฑุตูุฏ ุงูุญุงูู):"));
            if(!isNaN(amount)) {
                db.ref('users/' + id).update({ balance: amount })
                .then(() => alert("โ ุชู ุชุญุฏูุซ ุงูุฑุตูุฏ ุจูุฌุงุญ"))
                .catch(err => alert("โ ุฎุทุฃ: " + err.message));
            }
        }

        // ุฏุงูุฉ ุงูุฑุฏ ุนูู ุงูุฏุฑุฏุดุฉ
        function reply(id) {
            let msg = prompt("ุงูุชุจ ุฑุฏู ุงูุฐู ุณูุธูุฑ ูููุณุชุฎุฏู ูู ุตูุญุฉ ุงูุฏุฑุฏุดุฉ:");
            if(msg) {
                db.ref('users/' + id + '/messages').push({
                    s: 'a', // 'a' ุชุนูู Admin (ุงูููู ุงูุฑูุงุฏู ูู ุงูุฌุงุช)
                    t: msg,
                    time: new Date().getTime()
                }).then(() => alert("โ ุชู ุฅุฑุณุงู ุงูุฑุฏ ูููุณุชุฎุฏู"));
            }
        }
    </script>
</body>
</html>